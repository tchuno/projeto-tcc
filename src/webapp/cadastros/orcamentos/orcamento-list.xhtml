<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:b="http://bootsfaces.net/ui"
	xmlns:gnfe="http://java.sun.com/jsf/composite/gnfe">
	<f:metadata>
		<f:viewAction action="#{orcamentoListBean.init}" onPostback="false" if="#{utilBean.securityOk}"/>
	</f:metadata>
	<ui:composition template="/templates/navegacao.xhtml">
		<ui:define name="tituloPagina">#{msg['orcamentoCrud.titulo']}</ui:define>
		<ui:define name="conteudo">
			<gnfe:excluirModal id="excluirModal" metodoExcluir="#{orcamentoListBean.excluir()}"/>
			<h:form id="form-orcamento-list">
				<div class="row default-form">
					<div class="col-sm-10 col-sm-offset-1">
						<h4 class="tituloForm"><h:outputText value="#{msg['filtroForm.label']}"/></h4>
						<div class="row">
							<div class="col-sm-6 noMarginBottom" >
								<div class="form-group">
									<b:inputText value="#{orcamentoListBean.filtro.id}" label="#{msg['numero.label']}"/>
								</div>
							</div>
							<div class="col-sm-6 noMarginBottom" >
								<div class="form-group">
									<b:inputText value="#{orcamentoListBean.filtro.cpfCnpj}" label="#{msg['cpfCnpj.label']}"
												 styleClass="mask-cpf-cnpj"/>
								</div>
							</div>
						</div>
						<div class="row">
							<div class="col-sm-6 noMarginBottom" >
								<div class="form-group">
									<h:outputLabel value="#{msg['cliente.label']}" styleClass="bf-no-message"/>
									<h:selectOneMenu styleClass="form-control bf-no-message" id="cliente-id" value="#{orcamentoListBean.filtro.clienteId}" label="#{msg['cliente.label']}" required="false">
										<f:selectItem itemValue="" itemLabel=""/>
										<f:selectItems value="#{orcamentoListBean.clientes}" var="cli" itemValue="#{cli.id}" itemLabel="#{cli.nome}"/>
									</h:selectOneMenu>
								</div>
							</div>
							<div class="col-sm-6 noMarginBottom" >
								<div class="form-group">
									<h:outputLabel value="#{msg['formaPagamento.label']}" styleClass="bf-no-message"/>
									<h:selectOneMenu styleClass="form-control bf-no-message" id="forma-pagamento-id" value="#{orcamentoListBean.filtro.formaPagamento}" label="#{msg['formaPagamento.label']}" required="false">
										<f:selectItem itemValue="" itemLabel=""/>
										<f:selectItems value="#{utilBean.getValues('FormaPagamento')}" var="fp" itemValue="#{fp}" itemLabel="#{msg['FormaPagamento.'.concat(fp).concat('.label')]}"/>
									</h:selectOneMenu>
								</div>
							</div>
						</div>
						<div class="row row-filtro">
							<div class="col-sm-6 col-sm-offset-6 noMarginBottom">
								<div style="float: right;">
									<div class="form-group" style="float: left;">
										<b:commandButton value="#{msg['buscar.label']}" styleClass="btn btn-primary btn-md" ajax="true" update="orcamento-list-id"/>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
				<div class="row">
					<div class="col-sm-12">
						<h:link outcome="/cadastros/orcamentos/orcamento-edit.xhtml" style="float: right;" styleClass="btn btn-primary btn-lg" rendered="#{menuBean.podeCadastrar()}">
							<h:outputText value="#{msg['adicionarOrcamento.label']}"/>
						</h:link>
					</div>
				</div>
				<div class="row">
					<div class="col-sm-12">
						<p:dataTable id="orcamento-list-id" var="orcamento" value="#{orcamentoListBean.dataModel}" rows="20" paginator="true" lazy="true"
									 paginatorTemplate="{CurrentPageReport} {PreviousPageLink} {PageLinks} {NextPageLink}"
									 currentPageReportTemplate="Total: {totalRecords}" scrollable="false" emptyMessage="#{msg['emptyMessage.label']}"
									 paginatorPosition="bottom">
							<p:column headerText="#{msg['id.label']}" style="width: 100px; text-align: center;" sortBy="#{orcamento.id}">
								<h:outputText value="#{orcamento.id}" />
							</p:column>
							<p:column headerText="#{msg['autor.label']}" style="text-align: center;" sortBy="#{orcamento.autor}">
								<h:outputText value="#{orcamento.autor.nome}" />
							</p:column>
							<p:column headerText="#{msg['cliente.label']}" style="text-align: center;" sortBy="#{orcamento.cliente}">
								<h:outputText value="#{orcamento.cliente.nome}" />
							</p:column>
							<p:column headerText="#{msg['formaPagamento.label']}" style="text-align: center;" sortBy="#{orcamento.formaPagamento}">
								<h:outputText value="#{msg['FormaPagamento.'.concat(orcamento.formaPagamento).concat('.label')]}" />
							</p:column>
							<p:column headerText="#{msg['total.label']}" style="text-align: center;">
								<h:outputText
										value="#{utilBean.totalGeral(orcamento.orcamentoProdutos)}"
										style="font-weight: 700">
									<f:convertNumber locale="pt-BR" currencySymbol="R$" type="currency"/>
								</h:outputText>
							</p:column>
							<p:column headerText="#{msg['statusNotaFiscal.label']}" style="text-align: center;">
								<h:outputText value="#{msg['StatusNotaFiscal.'.concat(orcamento.notaFiscal.statusNotaFiscal).concat('.label')]}" />
							</p:column>
							<p:column style="width: 120px; text-align: center" sortable="false" rendered="#{menuBean.podeEditar()}">
								<h:link outcome="/cadastros/orcamentos/orcamento-edit.xhtml?id=#{orcamento.id}"
										styleClass="btn btn-warning btn-editar"
										rendered="#{menuBean.podeEditar()}">
									<h:outputText value="#{msg['editar.label']}"/>
								</h:link>
								<p:commandLink value="#{msg['excluir.label']}"
											   onclick="openModal('excluir-orcamento-modal', 'form-orcamento-list:excluir-btn')"
											   class="btn btn-danger btn-excluir"
											   rendered="#{menuBean.podeExcluir()}">
									<f:setPropertyActionListener target="#{orcamentoListBean.orcamentoId}"
																 value="#{orcamento.id}"/>
								</p:commandLink>
							</p:column>
						</p:dataTable>
					</div>
				</div>
				<b:modal title="#{msg['confirmarExclusaoTitulo.label']}" styleClass="confirmar-modal excluir-orcamento-modal" rendered="#{menuBean.podeExcluir()}">
					<p><h4 class="msg-confirm"><h:outputText value="#{msg['registroExcluir.confirm']}"/> </h4></p>
					<f:facet name="footer">
						<b:button value="#{msg['cancelar.label']}" look="primary" dismiss="modal" onclick="return false;"/>
						<p:commandButton id="excluir-btn" value="#{msg['excluir.label']}" actionListener="#{orcamentoListBean.excluir()}" update="content-pg-id" styleClass="btn btn-danger" oncomplete="closeModal('excluir-orcamento-modal')"/>
					</f:facet>
				</b:modal>
			</h:form>
		</ui:define>
	</ui:composition>
</html>